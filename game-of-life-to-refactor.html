<script>
    var sirina = 400;
    var visina = 400;
    var matrica = createArray(visina);

    for (var i_P = 0; i_P < 400; i_P++) {
        matrica[i_P] = [];
    }

    var mr = createArray(visina);

    for (var matrica_sirina = 0; matrica_sirina < sirina; matrica_sirina++) {
        for (var matrica_visina = 0; matrica_visina < visina; matrica_visina++) {
            var nasumicni_broj1 = Math.random();
            var nasumicni_broj2 = (nasumicni_broj1 * 2);
            var nasumicni_binarni_broj = Math.floor(nasumicni_broj2);
            if (nasumicni_binarni_broj === 1) {
                matrica[matrica_sirina][matrica_visina] = 1;
            } else {
                matrica[matrica_sirina][matrica_visina] = 0;
            }
        }
    }

    let boje = {
        1: '#FF0000',
        0: '#FFFFFF'
    }

    function Game() {
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, 400, 400);
        for (var matrica_sirina = 1; matrica_sirina < sirina; matrica_sirina++) {
            for (var matrica_visina = 1; matrica_visina < y; matrica_visina++) {


                ctx.fillStyle = boje[matrica[matrica_sirina][matrica_visina]];
                ctx.fillRect(matrica_sirina, matrica_visina, 1, 1);

            }
        }

       Animacija();
       requestAnimationFrame(Game);
    }

    function createArray(redovi) {
        var lista = [];
        for (var i_P = 0; i_P < redovi; i_P++) {
            lista[i_P] = [];
        }
        return lista;
    }

    function Animacija() {
        for (var matrica_sirina = 1; matrica_sirina < sirina - 1; matrica_sirina++) {
            for (var matrica_visina = 1; matrica_visina < visina - 1; matrica_visina++) {

                if (matrica[matrica_sirina][matrica_visina] === 0) {
                    switch (matrica[matrica_sirina - 1][matrica_visina - 1] + matrica[matrica_sirina - 1][matrica_visina] + matrica[matrica_sirina - 1][matrica_visina + 1] + matrica[matrica_sirina][matrica_visina - 1] + matrica[matrica_sirina][matrica_visina + 1] + matrica[matrica_sirina + 1][matrica_visina - 1] + matrica[matrica_sirina + 1][matrica_visina] + matrica[matrica_sirina + 1][matrica_visina + 1]) {
                        case 1:
                        case 2:
                            mr[matrica_sirina][matrica_visina] = 0;
                            break;
                        case 3:
                            mr[matrica_sirina][matrica_visina] = 1;
                            break;
                        case 4:
                            mr[matrica_sirina][matrica_visina] = 1;
                        case 5:
                            mr[matrica_sirina][matrica_visina] = !(mr[matrica_sirina][matrica_visina] | !mr[matrica_sirina][matrica_visina]);
                        default:
                            mr[matrica_sirina][matrica_visina] = 0;
                    }
                } else if (matrica[matrica_sirina][matrica_visina] === 1) {
                    switch (matrica[matrica_sirina - 1][matrica_visina - 1] + matrica[matrica_sirina - 1][matrica_visina] + matrica[matrica_sirina - 1][matrica_visina + 1] + matrica[matrica_sirina][matrica_visina - 1] + matrica[matrica_sirina][matrica_visina + 1] + matrica[matrica_sirina + 1][matrica_visina - 1] + matrica[matrica_sirina + 1][matrica_visina] + matrica[matrica_sirina + 1][matrica_visina + 1]) {
                        case 0:
                        case 1:
                            mr[matrica_sirina][matrica_visina] = (mr[matrica_sirina][matrica_visina] | !mr[matrica_sirina][matrica_visina]);
                            break;
                        case 2:
                            mr[matrica_sirina][matrica_visina] = (mr[matrica_sirina][matrica_visina] | !mr[matrica_sirina][matrica_visina]);
                        case 3:
                            mr[matrica_sirina][matrica_visina] = 1;
                            break;
                        case 4:
                        case 5:
                            mr[matrica_sirina][matrica_visina] = (mr[matrica_sirina][matrica_visina] & !mr[matrica_sirina][matrica_visina]);
                        case 6:
                        case 7:
                        case 8:
                            mr[matrica_sirina][matrica_visina] = 0;
                            break;
                        default:
                            mr[matrica_sirina][matrica_visina] = 0;

                    }

                }
            }
        }

        for (var matrica_sirina = 0; matrica_sirina < sirina; matrica_sirina++) {
            for (var matrica_visina = 0; matrica_visina < visina; matrica_visina++) {
                matrica[matrica_sirina][matrica_visina] = mr[matrica_sirina][matrica_visina];

            }
        }


    }
</script>
<html>

<body onload="Game()">
    <canvas id="myCanvas" width="400" height="400"></canvas>
</body>

</html>
